local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local checkpoints = {}
local selectedCheckpoint = nil
local autoTeleport = false
local teleportInterval = 5
local lastTeleportTime = 0

-- GUI setup
local gui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
gui.Name = "CheckpointGui"
gui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 300, 0, 350)
mainFrame.Position = UDim2.new(0, 50, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = gui

local title = Instance.new("TextLabel", mainFrame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Text = "Checkpoint Manager"
title.TextColor3 = Color3.new(1, 1, 1)
title.BackgroundTransparency = 1
title.Font = Enum.Font.SourceSansBold
title.TextSize = 20

local nameBox = Instance.new("TextBox", mainFrame)
nameBox.PlaceholderText = "T√™n checkpoint"
nameBox.Size = UDim2.new(1, -20, 0, 30)
nameBox.Position = UDim2.new(0, 10, 0, 40)
nameBox.Text = ""
nameBox.TextSize = 18
nameBox.Font = Enum.Font.SourceSans

local saveBtn = Instance.new("TextButton", mainFrame)
saveBtn.Text = "L∆∞u checkpoint"
saveBtn.Size = UDim2.new(1, -20, 0, 30)
saveBtn.Position = UDim2.new(0, 10, 0, 80)
saveBtn.BackgroundColor3 = Color3.fromRGB(60, 180, 60)
saveBtn.TextColor3 = Color3.new(1,1,1)
saveBtn.Font = Enum.Font.SourceSansBold
saveBtn.TextSize = 16

local listFrame = Instance.new("ScrollingFrame", mainFrame)
listFrame.Size = UDim2.new(1, -20, 0, 160)
listFrame.Position = UDim2.new(0, 10, 0, 120)
listFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
listFrame.ScrollBarThickness = 6
listFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
local uiList = Instance.new("UIListLayout", listFrame)
uiList.Padding = UDim.new(0, 4)
uiList.SortOrder = Enum.SortOrder.LayoutOrder

local toggleLoop = Instance.new("TextButton", mainFrame)
toggleLoop.Text = "B·∫≠t l·∫∑p l·∫°i"
toggleLoop.Size = UDim2.new(0.48, -5, 0, 30)
toggleLoop.Position = UDim2.new(0, 10, 1, -70)
toggleLoop.BackgroundColor3 = Color3.fromRGB(60, 130, 180)
toggleLoop.TextColor3 = Color3.new(1,1,1)
toggleLoop.Font = Enum.Font.SourceSansBold
toggleLoop.TextSize = 16

local timeBox = Instance.new("TextBox", mainFrame)
timeBox.Size = UDim2.new(0.48, -5, 0, 30)
timeBox.Position = UDim2.new(0.52, 5, 1, -70)
timeBox.PlaceholderText = "Gi√¢y gi·ªØa m·ªói l·∫ßn"
timeBox.Text = ""
timeBox.TextSize = 16
timeBox.Font = Enum.Font.SourceSans

local hideBtn = Instance.new("TextButton")
hideBtn.Size = UDim2.new(0, 100, 0, 30)
hideBtn.Position = UDim2.new(0, 10, 0.9, 0)
hideBtn.BackgroundColor3 = Color3.fromRGB(180, 50, 50)
hideBtn.TextColor3 = Color3.new(1, 1, 1)
hideBtn.Text = "·∫®n GUI"
hideBtn.Font = Enum.Font.SourceSansBold
hideBtn.TextSize = 16
hideBtn.Parent = mainFrame

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 100, 0, 30)
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.BackgroundColor3 = Color3.fromRGB(80, 80, 200)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Text = "Hi·ªán GUI"
toggleButton.Font = Enum.Font.SourceSansBold
toggleButton.TextSize = 16
toggleButton.Parent = gui
toggleButton.Visible = false
toggleButton.Active = true
toggleButton.Draggable = true

hideBtn.MouseButton1Click:Connect(function()
	mainFrame.Visible = false
	toggleButton.Visible = true
end)

toggleButton.MouseButton1Click:Connect(function()
	mainFrame.Visible = true
	toggleButton.Visible = false
end)

-- Functions
local function refreshList()
	for _, c in pairs(listFrame:GetChildren()) do
		if c:IsA("Frame") then c:Destroy() end
	end

	for i, checkpoint in ipairs(checkpoints) do
		local row = Instance.new("Frame")
		row.Size = UDim2.new(1, 0, 0, 30)
		row.BackgroundColor3 = checkpoint.locked and Color3.fromRGB(70, 30, 30) or Color3.fromRGB(50, 50, 50)
		row.Parent = listFrame

		local label = Instance.new("TextLabel", row)
		label.Size = UDim2.new(0.4, 0, 1, 0)
		label.Text = checkpoint.name
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.new(1,1,1)
		label.Font = Enum.Font.SourceSans
		label.TextSize = 16

		local tp = Instance.new("TextButton", row)
		tp.Text = "TP"
		tp.Size = UDim2.new(0.2, -5, 1, 0)
		tp.Position = UDim2.new(0.4, 5, 0, 0)
		tp.Font = Enum.Font.SourceSansBold
		tp.TextSize = 16
		tp.BackgroundColor3 = Color3.fromRGB(80, 150, 80)
		tp.TextColor3 = Color3.new(1,1,1)
		tp.MouseButton1Click:Connect(function()
			if not checkpoint.locked then
				LocalPlayer.Character:MoveTo(checkpoint.pos.Position)
				selectedCheckpoint = checkpoint
			end
		end)

		local lock = Instance.new("TextButton", row)
		lock.Text = checkpoint.locked and "üîí" or "üîì"
		lock.Size = UDim2.new(0.2, -5, 1, 0)
		lock.Position = UDim2.new(0.6, 5, 0, 0)
		lock.Font = Enum.Font.SourceSansBold
		lock.TextSize = 16
		lock.BackgroundColor3 = Color3.fromRGB(180, 130, 30)
		lock.TextColor3 = Color3.new(1,1,1)
		lock.MouseButton1Click:Connect(function()
			checkpoint.locked = not checkpoint.locked
			refreshList()
		end)

		local del = Instance.new("TextButton", row)
		del.Text = "üóë"
		del.Size = UDim2.new(0.2, -5, 1, 0)
		del.Position = UDim2.new(0.8, 5, 0, 0)
		del.Font = Enum.Font.SourceSansBold
		del.TextSize = 16
		del.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
		del.TextColor3 = Color3.new(1,1,1)
		del.MouseButton1Click:Connect(function()
			table.remove(checkpoints, i)
			refreshList()
		end)
	end

	listFrame.CanvasSize = UDim2.new(0, 0, 0, uiList.AbsoluteContentSize.Y + 10)
end

saveBtn.MouseButton1Click:Connect(function()
	local char = LocalPlayer.Character
	if char and char:FindFirstChild("HumanoidRootPart") then
		local name = nameBox.Text ~= "" and nameBox.Text or "Checkpoint " .. tostring(#checkpoints + 1)
		table.insert(checkpoints, { name = name, pos = char.HumanoidRootPart.CFrame, locked = false })
		refreshList()
	end
end)

toggleLoop.MouseButton1Click:Connect(function()
	autoTeleport = not autoTeleport
	toggleLoop.Text = autoTeleport and "T·∫Øt l·∫∑p l·∫°i" or "B·∫≠t l·∫∑p l·∫°i"
end)

RunService.RenderStepped:Connect(function()
	if autoTeleport and selectedCheckpoint and tick() - lastTeleportTime >= teleportInterval then
		if not selectedCheckpoint.locked then
			local char = LocalPlayer.Character
			if char and char:FindFirstChild("HumanoidRootPart") then
				char.HumanoidRootPart.CFrame = selectedCheckpoint.pos
			end
			lastTeleportTime = tick()
		end
	end

	if tonumber(timeBox.Text) then
		teleportInterval = tonumber(timeBox.Text)
	end
end)
local exitBtn = Instance.new("TextButton")
exitBtn.Size = UDim2.new(0, 100, 0, 30)
exitBtn.Position = UDim2.new(1, -110, 0.9, 0)
exitBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
exitBtn.TextColor3 = Color3.new(1, 1, 1)
exitBtn.Text = "Tho√°t GUI"
exitBtn.Font = Enum.Font.SourceSansBold
exitBtn.TextSize = 16
exitBtn.Parent = mainFrame

exitBtn.MouseButton1Click:Connect(function()
	gui:Destroy()
end)
